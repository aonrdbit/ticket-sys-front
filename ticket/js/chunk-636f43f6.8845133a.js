(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-636f43f6"],{3530:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"text-align":"center"}},[a("Header"),a("div",{staticStyle:{height:"10px"}}),a("div",{staticStyle:{margin:"auto",width:"100%"}},[a("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"车次管理",name:"first"}},[1==t.tabtab?a("div",[a("el-form",{ref:"form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"车次号"}},[a("el-input",{model:{value:t.trNo,callback:function(e){t.trNo=e},expression:"trNo"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.queryByTrNo}},[t._v("查询")]),a("el-button",{on:{click:function(e){t.tabtab=2}}},[t._v("添加新车次")])],1)],1),a("el-form",{ref:"dynamicValidateForm",staticClass:"demo-dynamic",attrs:{model:t.trains,"label-width":"auto;"}},[t._l(t.info,(function(e,l){return a("div",[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"车次号"}},[a("el-input",{attrs:{disabled:""},model:{value:t.trNo,callback:function(e){t.trNo=e},expression:"trNo"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"出发站"}},[a("el-input",{model:{value:e.stationA,callback:function(a){t.$set(e,"stationA",a)},expression:"ls.stationA"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"到达站"}},[a("el-input",{model:{value:e.stationB,callback:function(a){t.$set(e,"stationB",a)},expression:"ls.stationB"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"停留时间"}},[a("el-input",{model:{value:e.dwellTime,callback:function(a){t.$set(e,"dwellTime",a)},expression:"ls.dwellTime"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"出发时间"}},[a("el-input",{model:{value:e.staTime,callback:function(a){t.$set(e,"staTime",a)},expression:"ls.staTime"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"到达时间"}},[a("el-input",{model:{value:e.arrTime,callback:function(a){t.$set(e,"arrTime",a)},expression:"ls.arrTime"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"item",attrs:{label:"一等座价格"}},[a("el-input",{model:{value:e.firPrice,callback:function(a){t.$set(e,"firPrice",a)},expression:"ls.firPrice"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"item",attrs:{label:"二等座价格"}},[a("el-input",{model:{value:e.secPrice,callback:function(a){t.$set(e,"secPrice",a)},expression:"ls.secPrice"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"item",staticStyle:{"margin-top":"35px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(a){return a.preventDefault(),t.removeQueryVia(e)}}},[t._v("删除")])],1)],1)],1)],1)})),0!==t.info.length?a("el-row",[a("el-button",{on:{click:t.addQueryVia}},[t._v("新增经停车站")]),a("el-button",{attrs:{type:"primary"},on:{click:t.modTrain}},[t._v("确认修改车次信息")])],1):t._e()],2)],1):t._e(),2==t.tabtab?a("div",[a("div",{},[a("el-form",{ref:"dynamicValidateForm",staticClass:"demo-dynamic",attrs:{model:t.trains,"label-width":"auto;"}},[t._l(t.trains.list,(function(e,l){return a("div",[a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"车次号"}},[a("el-input",{model:{value:t.trains.trNo,callback:function(e){t.$set(t.trains,"trNo",e)},expression:"trains.trNo"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"出发站"}},[a("el-input",{model:{value:e.stationA,callback:function(a){t.$set(e,"stationA",a)},expression:"ls.stationA"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"到达站"}},[a("el-input",{model:{value:e.stationB,callback:function(a){t.$set(e,"stationB",a)},expression:"ls.stationB"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"停留时间"}},[a("el-input",{model:{value:e.dwellTime,callback:function(a){t.$set(e,"dwellTime",a)},expression:"ls.dwellTime"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"出发时间"}},[a("el-input",{model:{value:e.staTime,callback:function(a){t.$set(e,"staTime",a)},expression:"ls.staTime"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticClass:"item",attrs:{label:"到达时间"}},[a("el-input",{model:{value:e.arrTime,callback:function(a){t.$set(e,"arrTime",a)},expression:"ls.arrTime"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"item",attrs:{label:"一等座价格"}},[a("el-input",{model:{value:e.firPrice,callback:function(a){t.$set(e,"firPrice",a)},expression:"ls.firPrice"}})],1)],1),a("el-col",{attrs:{span:5}},[a("el-form-item",{staticClass:"item",attrs:{label:"二等座价格"}},[a("el-input",{model:{value:e.secPrice,callback:function(a){t.$set(e,"secPrice",a)},expression:"ls.secPrice"}})],1)],1),a("el-col",{attrs:{span:2}},[a("el-form-item",{staticClass:"item",staticStyle:{"margin-top":"35px"}},[a("el-button",{attrs:{type:"danger"},on:{click:function(a){return a.preventDefault(),t.removeVia(e)}}},[t._v("删除")])],1)],1)],1)],1)})),a("el-row",[a("el-button",{on:{click:t.addVia}},[t._v("新增经停车站")]),a("el-button",{on:{click:function(e){t.tabtab=1}}},[t._v("返回车次查询")]),a("el-button",{attrs:{type:"primary"},on:{click:t.addTrain}},[t._v("确认添加车次")])],1)],2)],1)]):t._e()]),a("el-tab-pane",{attrs:{label:"订单管理",name:"second"}},[a("div",[a("el-form",{ref:"form",attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"乘客身份证"}},[a("el-input",{model:{value:t.ID,callback:function(e){t.ID=e},expression:"ID"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.queryByID}},[t._v("查询")])],1)],1)],1),t._l(t.list,(function(e){return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",staticStyle:{"padding-bottom":"20px"},attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{float:"left"}},[t._v(" "+t._s(e.trNo)+" "+t._s(e.st)+"====>"+t._s(e.ed)+" "+t._s(t.fun(e.st_date))+" "+t._s(e.st_time)+"开 ")])]),a("div",{staticClass:"text item"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.psgs}},[a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"140"}}),a("el-table-column",{attrs:{prop:"idx",label:"身份证号",width:"180"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"140"}}),a("el-table-column",{attrs:{prop:"cx",label:"车厢",width:"120"}}),a("el-table-column",{attrs:{prop:"zw",label:"座位号",width:"120"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"140"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(l){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.tui(l.row,e)}}},[t._v("退票")])]}}],null,!0)})],1)],1)])],1)}))],2)],1)],1)],1)},s=[],i=a("0418"),r=a("b1ce");const o={Jan:"01",Feb:"02",Mar:"03",Sep:"09",Oct:"10",Nov:"11",Dec:"12"};var n=0,c=0,m={name:"Admin",data(){return{tabtab:1,trNo:"",test:"",ID:"",activeName:"first",dynamicValidateForm:{domains:[{value:""}],email:""},trains:{trNo:"",list:[{stationA:"",stationB:"",firPrice:"",secPrice:"",staTime:"",arrTime:"",dwellTime:"",idx:0}]},list:[],info:[]}},components:{Header:i["a"]},methods:{substr(t){return t[0]+t[1]+t[2]+t[3]+t[4]},fun(t){return t[24]+t[25]+t[26]+t[27]+"-"+o[t[4]+t[5]+t[6]]+"-"+t[8]+t[9]},tui(t,e){var a=new Date,l=a.getFullYear(),s=a.getMonth()+1,i=a.getDate();if("已退票"!==t.status){var n=e.st_date;this.check(parseInt(n[24]+n[25]+n[26]+n[27]),parseInt(o[n[4]+n[5]+n[6]]),parseInt(n[8]+n[9]),l,s,i)?this.$confirm("确认退票?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let a=this;this.$axios({method:"post",url:r["a"].base_url+"/order/del",data:{orId:e.orId+"",psgId:t.psgId+"",seNo:t.cx+"-"+t.zw,st:e.st+"",ed:e.ed+""}}).then((function(t){console.log(t.data),"true"===t.data.msg?(a.$message("退票成功"),a.getAllOrder()):a.$message("网络或内部错误")})).catch((function(t){console.log("err",t),a.$message("网络或内部错误")}))}).catch(()=>{this.$message({type:"info",message:"已取消"})}):this.$alert("不可以退开车时间在7天之内的车票","",{confirmButtonText:"确定"})}else this.$alert("该车票已退票","",{confirmButtonText:"确定"})},queryByID(){let t=this;this.$axios({method:"post",url:r["a"].base_url+"/admin/order/all",data:{ID:t.ID}}).then((function(e){console.log(e.data),"true"===e.data.msg?t.list=e.data.list:t.$message("网络或内部错误")}))},check(){"admin"!==localStorage.getItem("username")&&this.$router.push("/")},handleClick(t,e){console.log(t,e)},submitForm(t){this.$refs[t].validate(t=>{if(!t)return console.log("error submit!!"),!1;alert("submit!")})},resetForm(t){this.$refs[t].resetFields()},removeDomain(t){var e=this.dynamicValidateForm.domains.indexOf(t);-1!==e&&this.dynamicValidateForm.domains.splice(e,1)},addVia(){n++;var t={};t.idx=n,this.trains.list.push(t)},addQueryVia(){c++;var t={};t.idx=c,this.info.push(t)},removeVia(t){var e=this.trains.list.indexOf(t);-1!==e&&(this.trains.list.splice(e,1),n--)},removeQueryVia(t){var e=this.info.indexOf(t);-1!==e&&(this.info.splice(e,1),c--)},addTrain(){let t=this;this.$axios({method:"post",url:r["a"].base_url+"/admin/train/add",data:{train:t.trains}}).then((function(e){console.log(e.data),"true"===e.data.msg?t.$message("添加成功"):t.$message("网络或内部错误")}))},modTrain(){let t=this;for(var e=0;e<t.info.length;e++)t.info[e].dwellTime+="";this.$axios({method:"post",url:r["a"].base_url+"/admin/train/mod",data:{trNo:t.trNo+"",list:t.info}}).then((function(e){console.log(e.data),"true"===e.data.msg?t.$message("修改成功"):t.$message("网络或内部错误")}))},queryByTrNo(){let t=this;this.$axios({method:"post",url:r["a"].base_url+"/admin/train/query",data:{trNo:t.trNo}}).then((function(e){console.log(e.data),"true"===e.data.msg?(t.info=e.data.list,c=t.info.length):t.$message("网络或内部错误")}))}},created(){this.check()},mounted(){this.check()}},u=m,d=(a("651f"),a("2877")),f=Object(d["a"])(u,l,s,!1,null,"c627067c",null);e["default"]=f.exports},6358:function(t,e,a){},"651f":function(t,e,a){"use strict";var l=a("6358"),s=a.n(l);s.a}}]);
//# sourceMappingURL=chunk-636f43f6.8845133a.js.map