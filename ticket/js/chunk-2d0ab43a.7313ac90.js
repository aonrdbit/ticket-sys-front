(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0ab43a"],{1511:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{"text-align":"center"}},[a("Header"),a("div",{staticStyle:{height:"50px"}}),a("div",{staticStyle:{margin:"auto",width:"1040px"}},[a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"我的订单",name:"first"}},e._l(e.orders,(function(t){return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",staticStyle:{"padding-bottom":"20px"},attrs:{slot:"header"},slot:"header"},[a("span",{staticStyle:{float:"left"}},[e._v(" "+e._s(t.trNo)+" "+e._s(t.st)+"====>"+e._s(t.ed)+" "+e._s(e.fun(t.st_date))+" "+e._s(t.st_time)+"开 ")])]),a("div",{staticClass:"text item"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.psgs}},[a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"140"}}),a("el-table-column",{attrs:{prop:"idx",label:"身份证号",width:"180"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"140"}}),a("el-table-column",{attrs:{prop:"cx",label:"车厢",width:"120"}}),a("el-table-column",{attrs:{prop:"zw",label:"座位号",width:"120"}}),a("el-table-column",{attrs:{prop:"status",label:"状态",width:"140"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(s){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.tui(s.row,t)}}},[e._v("退票")])]}}],null,!0)})],1)],1)])],1)})),0),a("el-tab-pane",{attrs:{label:"我的联系人",name:"second"}},[a("div",{staticStyle:{padding:"15px"}},[a("el-form",{staticClass:"demo-form-inline",staticStyle:{float:"left"},attrs:{inline:!0}},[a("el-form-item",{attrs:{label:"添加常用联系人"}}),a("el-form-item",{attrs:{label:"姓名"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.addName,callback:function(t){e.addName=t},expression:"addName"}})],1),a("el-form-item",{attrs:{label:"身份证号码"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.addID,callback:function(t){e.addID=t},expression:"addID"}})],1),a("el-form-item",{attrs:{label:"手机号码"}},[a("el-input",{attrs:{placeholder:"请输入姓名"},model:{value:e.addPhone,callback:function(t){e.addPhone=t},expression:"addPhone"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.addLine}},[e._v("增加")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.friends}},[a("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),a("el-table-column",{attrs:{prop:"idx",label:"身份证号码"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号码"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.delPsg(t.row)}}},[e._v("删除")])]}}])})],1)],1)]),a("el-tab-pane",{attrs:{label:"修改密码",name:"third"}},[a("div",{staticStyle:{margin:"0 auto",width:"400px"}},[a("h3",{staticClass:"sign-title"},[e._v("修改密码")]),a("div",{staticStyle:{"text-align":"justify"}},[a("el-form",{attrs:{"label-position":"left","label-width":"100px",model:e.changeForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"原密码"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入原密码"},model:{value:e.changeForm.oldPass,callback:function(t){e.$set(e.changeForm,"oldPass",t)},expression:"changeForm.oldPass"}})],1),a("el-form-item",{attrs:{label:"新密码"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入新密码"},model:{value:e.changeForm.newPass,callback:function(t){e.$set(e.changeForm,"newPass",t)},expression:"changeForm.newPass"}})],1),a("el-form-item",{attrs:{label:"确认新密码"}},[a("el-input",{attrs:{type:"password",placeholder:"请再次输入新密码"},model:{value:e.changeForm.reNewPass,callback:function(t){e.$set(e.changeForm,"reNewPass",t)},expression:"changeForm.reNewPass"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.changePass}},[e._v("确认修改")])],1)],1)],1)])])],1)],1)],1)},l=[],r=a("0418"),o=a("b1ce");const n={Jan:"01",Feb:"02",Mar:"03",Sep:"09",Oct:"10",Nov:"11",Dec:"12"};var i={name:"User",components:{Header:r["a"]},data(){var e=(e,t,a)=>{""===t?a(new Error("请输入密码")):(""!==this.changeForm.reNewPass&&this.$refs.ruleForm.validateField("checkPass"),a())},t=(e,t,a)=>{""===t?a(new Error("请再次输入密码")):t!==this.changeForm.newPass?a(new Error("两次输入密码不一致!")):a()};return{addName:"",addID:"",addPhone:"",friends:[],activeName:"first",orders:[],changeForm:{oldPass:"",newPass:"",reNewPass:""},rules:{oldPass:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPass:[{validator:e,trigger:"blur"}],reNewPass:[{validator:t,trigger:"blur"}]}}},methods:{changePass(){if(this.changeForm.newPass!==this.changeForm.reNewPass)return void this.$message("密码不一致");let e=this;this.$axios({method:"post",url:o["a"].base_url+"/user/pass/mod",data:{userName:e.$store.state.username.toString(),oldPass:e.changeForm.oldPass+"",newPass:e.changeForm.newPass+""}}).then((function(t){e.$message(t.data.msg),"修改成功"===t.data.msg&&(e.changeForm.newPass="",e.changeForm.oldPass="",e.changeForm.reNewPass="")})).catch((function(t){console.log(t),e.$message("网络或内部错误")}))},fun(e){return e[24]+e[25]+e[26]+e[27]+"-"+n[e[4]+e[5]+e[6]]+"-"+e[8]+e[9]},getAllOrder(){let e=this;this.$axios({method:"post",url:o["a"].base_url+"/order/all",data:{userId:e.$store.state.userId.toString()}}).then((function(t){e.orders=t.data.list})).catch((function(t){e.$message("网络或内部错误")}))},getAllPassenger(){let e=this;this.$axios({method:"post",url:o["a"].base_url+"/user/passenger/all",data:{userId:e.$store.state.userId.toString()}}).then((function(t){console.log(t.data),e.friends=t.data.list})).catch((function(t){console.log("err",t),e.$message("网络或内部错误")}))},addLine(){let e=this;this.$axios({method:"post",url:o["a"].base_url+"/user/passenger/add",data:{userId:e.$store.state.userId+"",Name:e.addName+"",ID:e.addID+"",phone:e.addPhone+""}}).then((function(t){console.log(t.data),"true"===t.data.msg?e.getAllPassenger():e.$message("添加错误，请检查信息")})).catch((function(t){console.log("err",t),e.$message("网络或内部错误")}))},delPsg(e){let t=this;this.$axios({method:"post",url:o["a"].base_url+"/user/passenger/del",data:{userId:t.$store.state.userId+"",psgId:e.psgId+""}}).then((function(e){console.log(e.data),"true"===e.data.msg?(t.$message("删除成功"),t.getAllPassenger()):t.$message("网络或内部错误")})).catch((function(e){console.log("err",e),t.$message("网络或内部错误")}))},check(e,t,a,s,l,r){var o;return o=s<e?31-r+a:a-r,console.log(o),o>7},tui(e,t){var a=new Date,s=a.getFullYear(),l=a.getMonth()+1,r=a.getDate();if("已退票"!==e.status){var i=t.st_date;this.check(parseInt(i[24]+i[25]+i[26]+i[27]),parseInt(n[i[4]+i[5]+i[6]]),parseInt(i[8]+i[9]),s,l,r)?this.$confirm("确认退票?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{let a=this;this.$axios({method:"post",url:o["a"].base_url+"/order/del",data:{orId:t.orId+"",psgId:e.psgId+"",seNo:e.cx+"-"+e.zw,st:t.st+"",ed:t.ed+""}}).then((function(e){console.log(e.data),"true"===e.data.msg?(a.$message("退票成功"),a.getAllOrder()):a.$message("网络或内部错误")})).catch((function(e){console.log("err",e),a.$message("网络或内部错误")}))}).catch(()=>{this.$message({type:"info",message:"已取消"})}):this.$alert("不可以退开车时间在7天之内的车票","",{confirmButtonText:"确定"})}else this.$alert("该车票已退票","",{confirmButtonText:"确定"})},handleClick(e,t){console.log(e,t)},quit(){this.$router.push({path:"/list",query:{st:this.$route.query.st,ed:this.$route.query.ed,date:this.$route.query.date.toString()}})},st_timeformat(e){return e[0]+e[1]+e[2]+e[3]+e[4]},timeformat(e){return e[11]+e[12]+e[13]+e[14]+"-"+n[e[4]+e[5]+e[6]]+"-"+e[8]+e[9]}},created(){this.getAllPassenger(),this.getAllOrder()},mounted(){this.getAllPassenger(),this.getAllOrder()}},d=i,c=a("2877"),u=Object(c["a"])(d,s,l,!1,null,"3faa27ce",null);t["default"]=u.exports}}]);
//# sourceMappingURL=chunk-2d0ab43a.7313ac90.js.map